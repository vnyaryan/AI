{
    "command_group": "az image builder",
    "description": "Manage and build image builder templates.",
    "status": "GA",
    "commands": [
        {
            "name": "az image builder cancel",
            "summary": "Cancel the long running image build based on the image template.",
            "syntax": "az image builder cancel [--ids]\n                        [--name]\n                        [--resource-group]\n                        [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--ids",
                "--name -n",
                "--resource-group -g",
                "--subscription"
            ],
            "examples": [
                "az image builder cancel -n mytemplate -g my-group"
            ]
        },
        {
            "name": "az image builder create",
            "summary": "Create an image builder template.",
            "syntax": "az image builder create --name\n                        --resource-group\n                        [--build-timeout]\n                        [--build-vm-identities]\n                        [--checksum]\n                        [--defer]\n                        [--identity]\n                        [--image-source]\n                        [--image-template]\n                        [--location]\n                        [--managed-image-destinations]\n                        [--no-wait]\n                        [--os-disk-size]\n                        [--proxy-vm-size]\n                        [--scripts]\n                        [--shared-image-destinations]\n                        [--staging-resource-group]\n                        [--subnet]\n                        [--tags]\n                        [--validator]\n                        [--vm-size]\n                        [--vnet]",
            "required_parameters": [
                "--name -n",
                "--resource-group -g"
            ],
            "optional_parameters": [
                "--build-timeout",
                "--build-vm-identities",
                "--checksum",
                "--defer",
                "--identity",
                "--image-source -i",
                "--image-template",
                "--location -l",
                "--managed-image-destinations",
                "--no-wait",
                "--os-disk-size",
                "--proxy-vm-size",
                "--scripts",
                "--shared-image-destinations",
                "--staging-resource-group",
                "--subnet",
                "--tags",
                "--validator",
                "--vm-size",
                "--vnet"
            ],
            "examples": [
                "scripts=\"https://my-script-url.net/customize_script.sh\"\nimagesource=\"Canonical:0001-com-ubuntu-server-jammy:22_04-lts-gen2:latest\"\n\naz image builder create --image-source $imagesource -n myTemplate -g myGroup \\\n    --scripts $scripts --managed-image-destinations image_1=westus \\\n    --shared-image-destinations my_shared_gallery/linux_image_def=westus,brazilsouth \\\n    --identity myIdentity --staging-resource-group myStagingResourceGroup",
                "az image builder create -g my-group -n myTemplate --image-template filename",
                "script=\"https://my-script-url.com/customize_script.ps1\"\nimagesource=\"MicrosoftWindowsServer:WindowsServer:2019-Datacenter:2019.0.20190214\"\n\n# create and update template object in local cli cache. Defers put request to ARM\n# Cache object ttl set via az configure.\naz image builder create --image-source $imagesource -n myTemplate \\\n    -g myGroup --scripts $script --identity myIdentity --defer\n\n# add customizers\naz image builder customizer add -n myTemplate -g myGroup  \\\n    --customizer-name myPwshScript --exit-codes 0 1 --inline-script \\\n    \"mkdir c:\\buildActions\" \"echo Azure-Image-Builder-Was-Here \\\n     > c:\\buildActions\\Output.txt\" --type powershell --defer\n\naz image builder customizer add -n myTemplate -g myGroup \\\n    --customizer-name myFileCustomizer --type file \\\n    --file-source \"https://my-file-source.net/file.txt\"  \\\n    --dest-path \"c:\\buildArtifacts\\file.txt\" --defer\n\n# add distributors\naz image builder output add -n myTemplate -g myGroup --is-vhd \\\n    --output-name myWinImageVhd --artifact-tags \"is_vhd=True\" --defer\n\naz image builder output add -n myTemplate -g myGroup \\\n    --output-name myWinImageManaged --managed-image winImage \\\n    --managed-image-location eastus \\\n    --artifact-tags \"is_vhd=False\" --defer\n\n# Stop deferring put request to ARM. Create the template from the object cache.\n# Cache object will be deleted.\naz image builder update -n myTemplate -g myGroup"
            ]
        },
        {
            "name": "az image builder delete",
            "summary": "Delete image builder template.",
            "syntax": "az image builder delete [--ids]\n                        [--name]\n                        [--resource-group]\n                        [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--ids",
                "--name -n",
                "--resource-group -g",
                "--subscription"
            ],
            "examples": [
                "az image builder delete --name MyImageTemplate --resource-group MyResourceGroup"
            ]
        },
        {
            "name": "az image builder list",
            "summary": "List image builder templates.",
            "syntax": "az image builder list [--resource-group]",
            "required_parameters": [],
            "optional_parameters": [
                "--resource-group -g"
            ],
            "examples": []
        },
        {
            "name": "az image builder run",
            "summary": "Build an image builder template.",
            "syntax": "az image builder run [--ids]\n                     [--name]\n                     [--no-wait]\n                     [--resource-group]\n                     [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--ids",
                "--name -n",
                "--no-wait",
                "--resource-group -g",
                "--subscription"
            ],
            "examples": [
                "az image builder run -n mytemplate -g my-group --no-wait\n\naz image builder wait -n mytemplate -g aibmdi \\\n    --custom \"lastRunStatus.runState!='Running'\"\n\naz image builder show -n mytemplate -g my-group"
            ]
        },
        {
            "name": "az image builder show",
            "summary": "Show an image builder template.",
            "syntax": "az image builder show [--ids]\n                      [--name]\n                      [--resource-group]\n                      [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--ids",
                "--name -n",
                "--resource-group -g",
                "--subscription"
            ],
            "examples": [
                "az image builder show --name mytemplate  --resource-group my-group"
            ]
        },
        {
            "name": "az image builder show-runs",
            "summary": "Show an image builder template's run outputs.",
            "syntax": "az image builder show-runs [--ids]\n                           [--name]\n                           [--output-name]\n                           [--resource-group]\n                           [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--ids",
                "--name -n",
                "--output-name",
                "--resource-group -g",
                "--subscription"
            ],
            "examples": [
                "az image builder run -n mytemplate -g my-group --no-wait\n\naz image builder wait -n mytemplate -g aibmdi \\\n    --custom \"lastRunStatus.runState!='Running'\"\n\naz image builder show-runs -n mytemplate -g my-group"
            ]
        },
        {
            "name": "az image builder update",
            "summary": "Update an image builder template.",
            "syntax": "az image builder update [--add]\n                        [--defer]\n                        [--force-string]\n                        [--ids]\n                        [--name]\n                        [--remove]\n                        [--resource-group]\n                        [--set]\n                        [--subscription]",
            "required_parameters": [],
            "optional_parameters": [
                "--add",
                "--defer",
                "--force-string",
                "--ids",
                "--name -n",
                "--remove",
                "--resource-group -g",
                "--set",
                "--subscription"
            ],
            "examples": [
                "# create and write template object to local cli cache\naz image builder create --image-source {image_source} -n mytemplate -g my-group \\\n    --scripts {script} --managed-image-destinations image_1=westus --identity myidentity --defer\n\n# add customizers and outputs to local cache template object via az image template output / customizer add\n# one can also update cache object properties through generic update options, such as: --set\naz image builder output add -n mytemplate -g my-group --output-name my-win-image-managed \\\n    --artifact-tags \"is_vhd=False\"  --managed-image winImage --managed-image-location eastus --defer\n\n# send template create request to azure to create template resource\naz image builder update -n mytemplate -g my-group"
            ]
        },
        {
            "name": "az image builder wait",
            "summary": "Place the CLI in a waiting state until a condition of the template is met.",
            "syntax": "az image builder wait [--created]\n                      [--custom]\n                      [--deleted]\n                      [--exists]\n                      [--ids]\n                      [--interval]\n                      [--name]\n                      [--resource-group]\n                      [--subscription]\n                      [--timeout]\n                      [--updated]",
            "required_parameters": [],
            "optional_parameters": [
                "--created",
                "--custom",
                "--deleted",
                "--exists",
                "--ids",
                "--interval",
                "--name -n",
                "--resource-group -g",
                "--subscription",
                "--timeout",
                "--updated"
            ],
            "examples": [
                "az image builder run -n mytemplate -g my-group --no-wait\n\naz image builder wait -n mytemplate -g aibmdi \\\n    --custom \"lastRunStatus.runState!='Running'\"\n\naz image builder show -n mytemplate -g my-group"
            ]
        }
    ]
}